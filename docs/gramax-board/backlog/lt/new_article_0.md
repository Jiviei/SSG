---
order: 2
title: Технические детали
---

## [LanguageTool](https://languagetool.org/)

Свободно распространяемый инструмент для проверки грамматики, стиля и орфографии, поддерживающий русский язык

Возможности:

-  Позволяет создать собственные правила (существует [сайт](https://community.languagetool.org/ruleEditor2/index?lang=ru) для написания правил)

-  Поддерживает n-grams, (но не для русского)

   -  Для этого надо скачать файл ngrams соответствующего языка, например [здесь](https://languagetool.org/download/ngram-data/). Используются для пар слов прописанных в **confusion_sets** [например](https://github.com/languagetool-org/languagetool/blob/master/languagetool-language-modules/en/src/main/resources/org/languagetool/resource/en/confusion_sets.txt). У словарей расположенных в папке [untested](https://languagetool.org/download/ngram-data/untested/) мало или отсутствуют слова в **confusion_sets** (в том числе и у русского языка), поэтому ngrams не будут использоваться.

### Исследование

LanguageTool определяет каждое слово по  словарю частей речи (part-of-speech dictionary), стостоящему из различных форм слов. Каждая строка представляет собой сочетание слова и его грамматических характеристик, таких как род, число и падеж (для существительных и прилагательных), у других частей речи их соответствующие им [характеристики](https://github.com/languagetool-org/languagetool/blob/master/languagetool-language-modules/ru/src/main/resources/org/languagetool/resource/ru/tagset.txt)

[Пример слов, которые являются дополнительными](https://github.com/languagetool-org/languagetool/blob/master/languagetool-language-modules/ru/src/main/resources/org/languagetool/resource/ru/added.txt)

Пример для слова `обозреватель`:

```
форма слова	базовая форма	морфологическая разметка

обозревателей	обозреватель	NN:Inanim:Masc:PL:R
обозревателей	обозреватель	NN:Inanim:Masc:PL:V
обозревателем	обозреватель	NN:Inanim:Masc:Sin:T
обозревателе	обозреватель	NN:Inanim:Masc:Sin:P
обозреватели	обозреватель	NN:Inanim:Masc:PL:Nom
обозреватель	обозреватель	NN:Inanim:Masc:Sin:Nom
обозреватель	обозреватель	NN:Inanim:Masc:Sin:V
обозревателю	обозреватель	NN:Inanim:Masc:Sin:D
обозревателями	обозреватель	NN:Inanim:Masc:PL:T
обозревателям	обозреватель	NN:Inanim:Masc:PL:D
обозревателя	обозреватель	NN:Inanim:Masc:Sin:R
обозревателях	обозреватель	NN:Inanim:Masc:PL:P
```

маска `NN:Inanim:Masc:PL:R` значит:

```
NN - существительное
Inanim - неодушевленное
Masc - мужской род
PL - множественное число
R - родительный падеж
```

Правила пишутся исходя из сочетаний слов состоящих из харрактеристик слов. Можно смотреть как на само слово, так и на его базовую форму или морфологическую разметку

1. Значения слов

   1. Глаголы с пустым значением

   2. Слова, которые обозначают неопределенность

   3. Канцеляриты

   LanguageTool не определяет ни слова, которые обозначают неопределенность, ни канцеляриты или  глаголы с пустым значением, так как это какое-то значение слова исходя из контекста, а не какая-та форма слова

2. Вводные конструкции - пропустить этот пункт.

3. Числительные - все прописи чисел попадают под правило.

   Можно добавить

4. Сокращения - пример: Ghz, gb, tb.

   проверяя на русском языке, все слова написанные не кириллицей будут проигнорированы

5. Англицизмы - пропустить этот пункт.

6. Вы. Ваш - должно быть с маленькой буквы.

   Можно добавить

7. Буква ё

   Можно добавить

8. Страдательный залог

   Можно добавить краткие формы глагола (завершен, написано) и интранзитивные глаголы несовершенного вида со словом в творительном падеже (*заводится водителем*)

   [cut:Интранзитивный глагол несовершенного вида:false]

   Интранзитивным глаголом -- глагол, который не требует объекта для передачи своего действия. Обычно он образует действие, которое происходит внутри субъекта, то есть без воздействия на другие предметы или лиц.

   -  Глагол несовершенного вида -- это глагол, который обозначают незаконченное, длительное, без ограничения во времени действие или процесс

   [/cut]

   -  Ограничения

      -  `Машина заводится` -- не можем определить, потому что глагол такого же  вида, как и в словосочетании`Я иду` , где он не является страдательный

      -  `Машина заводится человеком` -- можем определить

9. Цепочки существительных - 3 включительно подряд.

   Можно добавить

10. Кавычки - должны быть только елочки.

    Можно добавить













































Какие правила происследованы:

-  Стоп слова:

   -  Для редактирования этих стоп-слов есть прототип формы ввода правил, в которую можно вписать начальные формы слов и сообщение к каждому правилу. При сохранении правил, оно парсится в xml и сохраняется в user-rules.xml с перезапуском сервера LanguageTool. При следующей проверке слова и их формы будут помечены как ошибки с соответствующими сообщенииями

-  Числительные - все прописи чисел попадают под правило

   -  Все числительные написанные словами, определяются как ошибка, с сообщением

      ```
      Используйте числительные в виде цифр для повышения читаемости текста
      ```

-  Вы/Ваш при использовании не в начале предложения

   -  Все слоова, у которых начальная форма  `вы` или `ваш`, определяются как ошибка, с сообщением

      ```
      Вы/Ваш не в начале предложения должно быть с маленькой буквы
      ```

-  Ошибка при использовании буквы “ё”

   -  Все слова с буквой “ё“ определяются как ошибка, с сообщением

      ```
      Используется буква "ё"
      ```

-  Страдательный залог

   -  краткие формы глагола (завершен, написано) и интранзитивные глаголы несовершенного вида со словом в творительном падеже (*заводится водителем*) помечаются как ошибка с сообщением

      ```
      Возможно страдательный залог
      ```

      [cut:Интранзитивный глагол несовершенного вида:false]

      Интранзитивным глаголом -- глагол, который не требует объекта для передачи своего действия. Обычно он образует действие, которое происходит внутри субъекта, то есть без воздействия на другие предметы или лиц.

      -  Глагол несовершенного вида -- это глагол, который обозначают незаконченное, длительное, без ограничения во времени действие или процесс

      [/cut]

      -  Ограничения

         -  `Машина заводится` -- не можем определить, потому что глагол такого же  вида, как и в словосочетании`Я иду` , где он не является страдательный

         -  `Машина заводится человеком` -- можем определить

-  Цепочки существительных - 3 включительно подряд

   -  Все цепочки из 3 существительных подряд определяются как ошибка, с сообщением

      ```
      В тексте обнаружена цепочка из трех и более существительных подряд
      ```

-  Кавычки - должны быть только елочки.

   -  Символы `“ ” " ' ‘ ’` определяются как ошибка, с сообщением

      ```
      Используйте кавычки-елочки
      ```

-  Можно настроить

   -  ignore.txt -- слова, которые будут проигнорированы средством проверки орфографии.

   -  prohibit.txt -- слова, которые должны быть помечены как орфографические ошибки, даже если программа проверки орфографии их распознает

      -  Ограничение

         -  Без форм



### Технические детали

-  Скорость работы

   -  Отправка одним текстом занимает больше времени, чем для каждой статьи отдельно. В дальнейшем, при получении множества запросов можно выводить последовательно, что ускорит первое отображение.

   -  Но, если отправлять 140 статей без текста быстрее будет при отправке одним запросом (скорее всего из-за того, что запросы висят в очереди на сервере)

-  Для изменения правил проверки надо:

   -  изменить правила в файле внутри **docker container,**

      правила для русского языка расположены по пути

      ```
      /LanguageTool-6.3/org/languagetool/rules/ru/grammar.xml
      ```

   -  перезапускать **docker container**

-  Разделение файла правил на дефолтные и кастомные

   -  для этого в файле grammar.xml надо прописать ссылку на файл с кастомными правилами

      ```
      <!DOCTYPE rules [
      <!ENTITY CustomRules SYSTEM "./org/languagetool/rules/ru/custom-rules.xml">
      ...
      ```

   -  и также в теле добавить этот объект

      ```
      <rules>
      	//дефолтные правила
      	&CustomRules;
      <rules>
      ```

-  Повторение пробела

   -  Правило отключается при отправке запроса на сервер

-  Парные символы (дефолтное)

   -  Если возникает ошибка в сопоставлении парных символов (скобки, кавычки) внутри других, то эта ошибка “тянет“ за собой также парные символы, внутри которых она находится, даже если в них нет ошибки. Например: `громоздкий (например “создаёт бесшовный опыт использования для сотрудников“ звучит как перевод с английского)` внутренние символы (кавычки) не сопоставятся, и из-за этого возникнет ошибка и с внешними (скобками), даже если присутствует парное соответствие внешних символов.



## Cspell

-  Инструмент командной строки и библиотека для проверки орфографии кода. **Cspell-lib** -- это библиотека, которая лежит в основе **cspell** и обеспечивает его функциональность. Эта библиотека предоставляет API для проверки орфографии. Её можно использовать в своем node приложении.

-  **cspell-lib**

   -  метод validateText принимает текст, настройки и необязательные опции, возвращает слово, в котором найдена ошибка, его смещение и предложения для исправления (если в опциях установлен флаг generateSuggestions)

-  Настройки:

   -  Стоп слова

   -  Разрешенные слова