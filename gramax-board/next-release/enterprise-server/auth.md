---
order: 4
title: Энтерпрайз-аутентификация
---

### [comment:2]Авторизация[/comment] в [app.gram.ax](http://app.gram.ax) и десктопном приложении

Сотрудник-редактор Х5:

1. **SSO в Enterprise-сервере**. Получает ссылку-приглашение на вход в enterprise-эккаут (например, https://editor.x5.local). Переходит по ссылке, и т.к. не был аутентифицировал тут прежде, то открывается окно SSO-логина. [comment:7]После успешной аутентификации[/comment] в браузере автоматически перекидывает на [app.gram.ax](http://app.gram.ax) .

   :::lab Под капотом

   -  [comment:9]На[/comment] editor.x5.local в их окружении будет развернут Gramax Enterprise Server

   -  При входе проверяем авторизован ли пользователь, если нет, то перенаправление на корпоративный Keycloak, после успешной аутентификации он возвращается авторизованный.

   -  Авторизованного пользователя перекидываем на [app.gram.ax](http://app.gram.ax) и также в ссылке передаем URL нашего enterprise-инстанса, с которого мы тянем информацию по конфигурации, в которой есть: темы, платины, лицензионная информация и т.д.

   -  Кнопки “Войти” в [app.gram.ax](http://app.gram.ax) не будет, т.к. вход может быть только через Enterprise-сервер.

   -  Есть еще вариант с кнопкой “Войти”, на котором открывается окно куда нужно ввести рабочий емейл и мы по домену можем отправить на enterprise-сервер, но тогда нам где-то у себя надо хранить список всех энтерпрайз-серверов, плюс ты не сможешь зарегистрироваться с обычной почтой в enterprise и не сможешь с одной почтой быть больше чем в одной организации.

   :::

2. **Спейс X5 на** [**app.gram.ax**](http://app.gram.ax). Пользователю на [app.gram.ax](http://app.gram.ax) появляется крутилка (загружается конфигурация, в т.ч. плагины с enterprise-сервера). После того как закрывается крутилка -- интерфейс преобразуется в стилизованный под X5 и становятся видны на странице спец-элементы от X5, т.к. подгрузились все специфичные плагины для X5.

3. **Переключатель спейсов**. В верхнем правом углу на главной странице появляется X5 с кареткой вниз. При клике на нее видим два элемента: X5 (активен), Личный. При клике на “Личный” стиль становится обычным, каталоги отображаются те, которые не относятся к окружению X5.

   1. **Кнопка “Выйти”**. При нахождении в корпоративном спейсе, сверху справа отображается кнопка “Выйти”. При нажатии на нее проверяются что нет несинхронизированных репозиториев, и если их нет спейс X5 пропадает, пока заново в него не войти.

4. **Базовые каталоги**. На главной странице показываются плашки каталогов, помеченные администратором Х5 как базовые (настроено в конфиге). В плашке каталога отображается иконка облачка, по которому понимает, что этот репозиторий еще не склонирован.

5. **Загрузка каталога по требованию**. При нажатии на плашку каталога с облачком, рядом с облаком начинает крутиться крутилка. После завершения загрузки каталог автоматически открывается. В загруженном каталоге есть связь с хранилищем. [comment:1]Если во время загрузки нажимаю на другой каталог, он также пытается открыться.[/comment]

6. **Корпоративное хранилище**. При нажатии “Добавить каталог” в выпадающем списке уже видит корпоративное хранилище. Если оно одно, то выбирается автоматически. Свои хранилища добавить не может.

7. **Обновление настроек**. При каждой загрузке приложения, конфигурационный файл всякий раз загружается и настройки могут обновиться, например могут добавиться платины. Если были добавлены новые базовые каталоги -- они появляются, а удаленные незагруженные исчезают.

### Авторизация на портал

Читатель портала:

1. [comment:3]**Автологин на портал через SSO**[/comment]. Присылают ссылку вида `x5.gram.ax/XXX`, при клике, если не был ранее авторизован -- перекидывает на SSO. После авторизации на нем, перекидывает обратно.

2. **Каталоги отфильтрованные по правам**. Видны все каталоги и статьи, отфильтрованные по правам, на основе групп в которые входит читатель.

### 