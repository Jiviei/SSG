---
order: 17
title: Перенос изменений в опенсурс
---

Я, как разработчик хочу иметь удобный и быстрый способ переноса изменений из основного гитлабовского репозитория в гитхаб.

Возможные решения:

-  Использование функции отзеркаливания репозиториев Автоматический перенос коммитов в гитхаб при любых коммитах в гитлабовский репозиторий.

   -  Плюсы:

      -  Все будет происходить автоматически без участия человека

      -  Легко переносить изменения

   -  Минусы:

      -  При зеркаливании зеркалится вся история, в том числе коммиты с секретами (т.е нужно будет чистить историю при помощи команды `git filter-branch` или при помощи утилит [BFG Repo-Cleaner](https://rtyley.github.io/bfg-repo-cleaner/) или [heinrichti/GitRewrite](https://github.com/heinrichti/GitRewrite))

-  Перетаскивание коммитов между несвязанными репозиториев При помощи CI/CD будет реализован механизм переноса коммитов между gitlab и github. Коммиты будут сквашиться (сжимать все коммиты в один) и переноситься в гитхаб.

   -  Возможный способ переносить изменения:

      -  `git tag -a "[название версии]" -m "[необязательный changelog]"`

      -  `git push --tags`

   -  Плюсы:

      -  Нет проблем с несвязанными историями веток

      -  Нет проблем с мерджом веток

      -  Легко переносить изменения

   -  Минусы:

      -  Нужно настраивать CI/CD

-  Создание ветки-сироты

   -  Как создать:

      -  `git checkout --orphan open-source-branch`

   -  Возможный способ переносить изменения:

      -  `git merge wysiwyg/develop open-source-branch`

      -  `git push upstream open-source-branch:master --force`

   -  Плюсы:

      -  Все можно делать из основного репозитория

   -  Минусы:

      -  В основном репозитории придется создавать еще одну ветку

      -  Каждому пользователю нужно добавлять будет добавлять ремоут на гитхаб

      -  Нельзя мерджить ветки без флага `--allow-unrelated-histories` из-за несвязанной истории изменений

      -  Возникает много конфликтов

-  Создание пустого репозитория с глубиной коммитов 1

   -  Возможный способ переносить изменения:

      -  `cd {путь до пустого репозитория}`

      -  `git merge wysiwyg/develop open-source-branch`

      -  `git push upstream open-source-branch:master --force`

   -  Плюсы:

      -  Нет возможности что-то сделать не то в основном репозитории

   -  Минусы:

      -  Нельзя делать сразу из папки с основным репозиторием, нужно переходить

      -  Каждому разработчику нужно создавать еще один репозиторий

      -  Все равно проблема с ремоутами

      -  Будут несвязанные истории при переносах изменений

-  Создание зеркального репозитория с глубиной коммитов 1

   -  Возможный способ переносить изменения:

      -  `git merge wysiwyg/develop --squash && git commit -m "Merge develop to open source"`

      -  `git push --mirror`

   -  Плюсы:

      -  Нет возможности что-то сделать не то в основном репозитории

      -  Легко переносить изменения

      -  Клонирует сразу всё

      -  Не нужно настраивать ремоуты

   -  Минусы:

      -  Нельзя делать сразу из папки с основным репозиторием, нужно переходить

      -  Будут несвязанные истории при переносах изменений

-  Откатиться до первого коммита и сделать все вторым коммитом

   -  Как создать (0e33777578101cffff645f687c8f656444dc5919 это первый коммит в гитлабовской репе):

      -  `git reset --soft 0e33777578101cffff645f687c8f656444dc5919 && git commit -m "init"`

      -  `git push upstream open-source-branch:master`

   -  Возможный способ переносить изменения:

      -  `git merge wysiwyg/develop --squash && git add . && git commit -m "Merge develop to opensource"`

      -  `git push upstream open-source-branch:master`

   -  Плюсы:

      -  Нет проблем с несвязанными историями веток

      -  Нет проблем с мерджом веток

      -  Легко переносить изменения

   -  Минусы:

      -  Нужно настраивать ремоуты

      -  При изначальном переносе будет как минимум два коммита, первый у Андрея в 2020 году и init коммит